---
import "../styles/global.css";
import Hero from "../components/landing/Hero.astro";
import FormatCard from "../components/landing/FormatCard.astro";
import { ensureDefaultFormatsRegistered } from "@/lib/tournament/formats/registry-seed";
import { tournamentFormatRegistry } from "@/lib/tournament/registry";
import type { TournamentFormatMetadata } from "@/lib/tournament/types";

ensureDefaultFormatsRegistered();

const formatMetadata: readonly TournamentFormatMetadata[] =
    tournamentFormatRegistry.getAll().map((format) => format.metadata);

const previewFeatures = [
    {
        title: "Brackets with connectors",
        description:
            "Static diagrams that highlight feedsInto relationships and how byes advance.",
        badge: "Progression",
        type: "bracket",
    },
    {
        title: "Schedules that stay readable",
        description:
            "Round-grouped fixtures to set expectations for players and broadcast cues.",
        badge: "Scheduling",
        type: "schedule",
    },
    {
        title: "Leaderboards ready for print",
        description:
            "Standings with wins, draws, losses, and points for quick posting or sharing.",
        badge: "Standings",
        type: "table",
    },
];
---

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>TournaGen</title>
    </head>
    <body class="surface font-sans">
        <main class="min-h-screen bg-gradient-to-b from-surface-50 via-white to-surface-50">
            <Hero />
            <section
                id="formats"
                class="px-6 py-16 sm:py-24 lg:py-28"
                aria-labelledby="formats-heading"
            >
                <div class="mx-auto flex max-w-6xl flex-col gap-10">
                    <div class="flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
                        <div class="space-y-3">
                            <div class="flex flex-wrap items-center gap-2">
                                <span class="pill">Registry-driven</span>
                                <span class="pill bg-white text-neutral-700 border-neutral-200">
                                    {formatMetadata.length} formats ready
                                </span>
                            </div>
                            <div class="space-y-2">
                                <h2
                                    id="formats-heading"
                                    class="font-display text-3xl sm:text-[2rem] leading-tight tracking-tight text-neutral-900"
                                >
                                    Pick the right tournament shape.
                                </h2>
                                <p class="max-w-3xl text-lg text-neutral-700">
                                    Cards are generated directly from the tournament registry—add a
                                    new format and it appears here automatically with its guidance and
                                    iconography.
                                </p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 sm:grid-cols-3">
                            <div class="card border-brand-100 px-4 py-3">
                                <p class="text-sm text-neutral-600">Client-side only</p>
                                <p class="text-lg font-semibold text-neutral-900">Offline after load</p>
                            </div>
                            <div class="card border-brand-100 px-4 py-3">
                                <p class="text-sm text-neutral-600">Visual language</p>
                                <p class="text-lg font-semibold text-neutral-900">
                                    Connectors built-in
                                </p>
                            </div>
                            <div class="card border-brand-100 px-4 py-3">
                                <p class="text-sm text-neutral-600">Export ready</p>
                                <p class="text-lg font-semibold text-neutral-900">Readable JSON</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
                        {formatMetadata.map((metadata) => (
                            <FormatCard metadata={metadata} />
                        ))}
                    </div>
                </div>
            </section>

            <section
                id="features"
                class="bg-white/70 px-6 py-16 backdrop-blur-sm sm:py-16 lg:py-16"
                aria-labelledby="features-heading"
            >
                <div class="mx-auto max-w-6xl space-y-10">
                    <div class="space-y-3">
                        <div class="flex flex-wrap items-center gap-2">
                            <span class="pill">Static previews</span>
                            <span class="pill bg-white text-neutral-700 border-neutral-200">
                                Visual clarity first
                            </span>
                        </div>
                        <h2
                            id="features-heading"
                            class="font-display text-3xl sm:text-[2rem] leading-tight tracking-tight text-neutral-900"
                        >
                            See how TournaGen presents your tournaments.
                        </h2>
                        <p class="max-w-3xl text-lg text-neutral-700">
                            Preview the bracket connectors, schedule layout, and leaderboard styling—
                            all rendered statically so the page stays fast on every device.
                        </p>
                    </div>

                    <div class="grid gap-5 md:grid-cols-2 lg:grid-cols-3">
                        {previewFeatures.map((feature) => (
                            <article class="card relative overflow-hidden border-brand-100 px-5 py-6 shadow-soft">
                                <div class="flex items-center justify-between gap-3">
                                    <div class="space-y-1">
                                        <p class="text-sm font-semibold uppercase tracking-wide text-accent-700">
                                            {feature.badge}
                                        </p>
                                        <h3 class="text-xl font-semibold text-neutral-900">
                                            {feature.title}
                                        </h3>
                                    </div>
                                    <div class="rounded-full bg-brand-50 px-3 py-1 text-xs font-semibold text-brand-700">
                                        Static demo
                                    </div>
                                </div>
                                <p class="mt-3 text-base text-neutral-700">
                                    {feature.description}
                                </p>

                                {feature.type === "bracket" && (
                                    <div class="mt-5 grid gap-3 sm:grid-cols-[1fr_auto_1fr] sm:items-center">
                                        <div class="space-y-2 rounded-lg border border-neutral-200 bg-white px-3 py-3 shadow-soft">
                                            <p class="text-xs text-neutral-500">Quarterfinal</p>
                                            <div class="flex items-center justify-between">
                                                <span class="font-semibold text-neutral-900">Seed 1</span>
                                                <span class="badge-accent">Adv</span>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="font-semibold text-neutral-900">Seed 8</span>
                                                <span class="text-xs text-neutral-500">Awaiting</span>
                                            </div>
                                        </div>
                                        <div class="hidden h-full w-12 items-center justify-center sm:flex">
                                            <div class="h-px w-10 bg-neutral-200" />
                                        </div>
                                        <div class="space-y-2 rounded-lg border border-neutral-200 bg-white px-3 py-3 shadow-soft">
                                            <p class="text-xs text-neutral-500">Semifinal</p>
                                            <div class="flex items-center justify-between">
                                                <span class="font-semibold text-neutral-900">Winner</span>
                                                <span class="badge-accent">Feeds into final</span>
                                            </div>
                                            <div class="bracket-connector" />
                                            <div class="flex items-center justify-between">
                                                <span class="font-semibold text-neutral-900">Next match</span>
                                                <span class="text-xs text-neutral-500">Connector</span>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {feature.type === "schedule" && (
                                    <div class="mt-5 space-y-2 rounded-lg border border-neutral-200 bg-white px-4 py-3 shadow-soft">
                                        <div class="flex items-center justify-between border-b border-dashed border-neutral-200 pb-2">
                                            <div>
                                                <p class="text-xs text-neutral-500">Round 1</p>
                                                <p class="font-semibold text-neutral-900">Alpha vs Bravo</p>
                                            </div>
                                            <span class="rounded-full bg-brand-50 px-3 py-1 text-xs font-semibold text-brand-700">
                                                12:00
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between border-b border-dashed border-neutral-200 pb-2">
                                            <div>
                                                <p class="text-xs text-neutral-500">Round 2</p>
                                                <p class="font-semibold text-neutral-900">Charlie vs Delta</p>
                                            </div>
                                            <span class="rounded-full bg-accent-50 px-3 py-1 text-xs font-semibold text-accent-800">
                                                12:40
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-xs text-neutral-500">Round 3</p>
                                                <p class="font-semibold text-neutral-900">Echo vs Foxtrot</p>
                                            </div>
                                            <span class="rounded-full bg-neutral-100 px-3 py-1 text-xs font-semibold text-neutral-700">
                                                13:20
                                            </span>
                                        </div>
                                    </div>
                                )}

                                {feature.type === "table" && (
                                    <div class="mt-5 overflow-hidden rounded-lg border border-neutral-200 bg-white shadow-soft">
                                        <div class="grid grid-cols-[1fr,auto,auto,auto] gap-3 border-b border-neutral-200 bg-surface-50 px-4 py-2 text-xs font-semibold text-neutral-600">
                                            <span>Team</span>
                                            <span class="text-right">W</span>
                                            <span class="text-right">D</span>
                                            <span class="text-right">Pts</span>
                                        </div>
                                        <div class="grid grid-cols-[1fr,auto,auto,auto] gap-3 px-4 py-2 text-sm text-neutral-800">
                                            <span class="font-semibold text-neutral-900">Falcons</span>
                                            <span class="text-right">3</span>
                                            <span class="text-right">0</span>
                                            <span class="text-right text-brand-700">9</span>
                                        </div>
                                        <div class="grid grid-cols-[1fr,auto,auto,auto] gap-3 bg-surface-50 px-4 py-2 text-sm text-neutral-800">
                                            <span class="font-semibold text-neutral-900">Orcas</span>
                                            <span class="text-right">2</span>
                                            <span class="text-right">1</span>
                                            <span class="text-right text-brand-700">7</span>
                                        </div>
                                        <div class="grid grid-cols-[1fr,auto,auto,auto] gap-3 px-4 py-2 text-sm text-neutral-800">
                                            <span class="font-semibold text-neutral-900">Comets</span>
                                            <span class="text-right">2</span>
                                            <span class="text-right">0</span>
                                            <span class="text-right text-brand-700">6</span>
                                        </div>
                                    </div>
                                )}
                            </article>
                        ))}
                    </div>
                </div>
            </section>
        </main>
    </body>
</html>
